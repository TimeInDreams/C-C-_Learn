# 编译概述

编译程序读取源程序（字符流），对之进行词法和语法的分析，将高级语言指令转换为功能等小的汇编代码，再有汇编程序转换为机器语言，并且按照操作系统对可执行文件格式的要求链接生成可执行程序。

* **预处理阶段**

  完成宏定义和include文件展开等工作；生成.i文件。GCC命令为：gcc -E

* **编译**

  根据编译参数进行不同程序的优化，编译成汇编代码；生成.s文件，命令：gcc - S

* **生成目标代码**

  用汇编器把上一阶段生成的汇编代码进一步生成目标代码；生成.o文件。命令：gcc -C

* **链接**

  用链接器把上一阶段生成的目标代码、其他一些相关的系统提供的目标代码和系统或用户提供的库链接起来，生成最终的执行代码。生成可执行文件

# 预处理Preprocessing

* **宏定义指令**

  如`#define pi 3.14`，预处理阶段会将程序中出现的所有的`pi`用3.14代替。与之对应的`#undef`则会取消对某个宏的定义，使后面出现时不再被替换

* **条件编译指令**

  如`#ifdef  #ifndef  #else  # elif  #endif`等伪指令的引入可以使得程序员可以通过定义不同的宏来决定编译程序对哪些代码进行处理，即预处理阶段将根据有关的文件将不必要的代码过滤掉

* **头文件包含指令**

  如`#include`，头文件中一般通过`#define`定义了一些宏，同时也包含了各种外部符号的声明。采用头文件可以使一些定义在不同的C源程序中使用，而不必在文件中重新定义。预处理阶段会将头文件中的定义加入冬引用它的代码中。

* **特殊符号**

  如在源程序中出现的`FUNCTION`会被解释为当前编译的C源程序中的函数名称。预处理阶段会对源程序中出现的这些特殊符号用合适的值进行替换。

## 总结

预处理阶段主要完成对源程序的替换工作。经过替换后，会生成一个没有宏定义、没有条件编译指令、没有特殊符号的输出文件.i，该输出文件中只有常量如数字、字符等，或者是变量的定义，以及C语言的关键字如`if else`等

# 编译Compilation



> https://www.jianshu.com/p/4dfa5dea63b5
>
> http://www.51hei.com/bbs/dpj-46187-1.html
>
> http://www.51hei.com/bbs/dpj-54868-1.html
>
> http://www.51hei.com/bbs/dpj-28952-1.html